---
# Example profile for Debian Trixie with pipeline tasks
# This demonstrates how to use pre-processors, provisioners, and post-processors
# to configure the system after bootstrap

dir: /tmp/debian-trixie-provisioned

# Isolation backend for running commands in rootfs
# Currently only 'chroot' is supported, with bwrap/systemd-nspawn planned for future
# If omitted, defaults to 'chroot'
isolation:
  type: chroot

bootstrap:
  type: mmdebstrap
  suite: trixie
  target: rootfs # Must be a directory for pipeline tasks to work
  mirrors:
  - https://deb.debian.org/debian
  variant: apt
  components:
  - main
  - contrib
  architectures:
  - amd64

# Pre-processors run before provisioners (optional)
# pre_processors:
# - type: shell
#   content: |-
#     #!/bin/sh
#     echo "Running pre-processor..."

provisioners:
# Example 1: Inline shell script
- type: shell
  content: |-
    #!/bin/sh
    set -e
    echo "Running inline provisioner..."
    apt-get update
    apt-get install -y vim htop curl
    echo "Provisioning complete!"
  shell: /bin/sh
  # Example 2: External shell script (uncomment to use)
  # - type: shell
  #   script: ./examples/scripts/configure-network.sh
  #   shell: /bin/bash

# Post-processors run after provisioners (optional)
# post_processors:
# - type: shell
#   content: |-
#     #!/bin/sh
#     echo "Running post-processor cleanup..."
